{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mcmp.local/schemas/tracks.schema.json",
  "title": "tracks/{trackId}",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "trackId","ownerUid","title","artistName","genre","moodTags","isrc","coverArtPath","externalLinks",
    "rightsTier","rightsAttestation","rightsReview","status","createdAt","updatedAt"
  ],
  "properties": {
    "trackId": { "type": "string", "minLength": 1 },
    "ownerUid": { "type": "string", "minLength": 1 },
    "title": { "type": "string", "minLength": 1, "maxLength": 120 },
    "artistName": { "type": "string", "minLength": 1, "maxLength": 120 },
    "genre": {
      "type": "string",
      "enum": [
        "pop","hiphop","rap","rnb","edm","house","techno","drumandbass","rock","indie","alternative","metal",
        "punk","latin","reggaeton","afrobeats","kpop","country","jazz","classical","singer_songwriter","folk",
        "instrumental","other"
      ]
    },
    "moodTags": {
      "type": "array",
      "maxItems": 10,
      "items": { "type": "string", "minLength": 1, "maxLength": 32 }
    },
    "isrc": { "type": ["string","null"], "pattern": "^[A-Z]{2}[A-Z0-9]{3}\\d{7}$" },
    "coverArtPath": { "type": ["string","null"], "minLength": 1 },
    "externalLinks": {
      "type": "object",
      "additionalProperties": false,
      "required": ["spotify","appleMusic","youtube","tiktokSound"],
      "properties": {
        "spotify": { "type": ["string","null"], "format": "uri" },
        "appleMusic": { "type": ["string","null"], "format": "uri" },
        "youtube": { "type": ["string","null"], "format": "uri" },
        "tiktokSound": { "type": ["string","null"], "format": "uri" }
      }
    },
    "rightsTier": { "type": "string", "enum": ["tier1_attestation","tier2_verified"] },
    "rightsAttestation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["attestsMasterRights","attestsPublishingRights","hasCoWritersOrSplits","acceptedAt"],
      "properties": {
        "attestsMasterRights": { "type": "boolean" },
        "attestsPublishingRights": { "type": "boolean" },
        "hasCoWritersOrSplits": { "type": "boolean" },
        "acceptedAt": { "$ref": "timestamp.schema.json" }
      }
    },
    "rightsReview": {
      "type": "object",
      "additionalProperties": false,
      "required": ["status","reviewedBy","reviewedAt"],
      "properties": {
        "status": { "type": "string", "enum": ["not_required","pending","approved","rejected"] },
        "reviewedBy": { "type": ["string","null"], "minLength": 1 },
        "reviewedAt": { "type": ["string","null"], "format": "date-time" }
      }
    },
    "status": { "type": "string", "enum": ["active","archived"] },
    "createdAt": { "$ref": "timestamp.schema.json" },
    "updatedAt": { "$ref": "timestamp.schema.json" }
  }
}
